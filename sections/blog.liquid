{% comment %} {{ 'component-article-card.css' | asset_url | stylesheet_tag }} {% endcomment %}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{% comment %} {{ 'section-main-blog.css' | asset_url | stylesheet_tag }} {% endcomment %}

{% style %}
/* ————— Article Card ———————————————————— */
.article {
  display: flex;
  align-items: center;
  &.grid__item {
    padding: 0;
  }
}
.grid--peek .article-card {
  box-sizing: border-box;
}
.article-card__image-wrapper > a {
  display: block;
}
.article-card__title {
  text-decoration: none;
  word-break: break-word;
  a:after {
    bottom: 0;
    content: '';
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    width: 100%;
    z-index: 1;
  }
}
.article-card__link {
  text-underline-offset: 0.3rem;
  &.link {
    padding: 0;
  }
  &:not(:only-child) {
    margin-right: 3rem;
  }
}
.article-card .card__heading {
  margin-bottom: 0.6rem;
}
.blog-articles .article-card .card__information, .blog__posts .article-card .card__information {
  padding-left: 2rem;
  padding-right: 2rem;
}
.article-card__info {
  padding-top: 0.4rem;
}
.article-card__footer {
  letter-spacing: 0.1rem;
  font-size: 1.4rem;
  &:not(:last-child) {
    margin-bottom: 1rem;
  }
  &:last-child {
    margin-top: auto;
  }
}
.article-card__excerpt {
  width: 100%;
  margin-top: 1.2rem;
}
.ratio::before {
  .article-card__image--small & {
    padding-bottom: 11rem;
  }
  .article-card__image--medium & {
    padding-bottom: 22rem;
  }
  .article-card__image--large & {
    padding-bottom: 33rem;
  }
}
@media screen and (max-width: 749px) {
  .articles-wrapper .article {
    width: 100%;
  }
}
@media screen and (min-width: 750px) {
  .ratio::before {
    .article-card__image--small & {
      padding-bottom: 14.3rem;
    }
    .article-card__image--medium & {
      padding-bottom: 21.9rem;
    }
    .article-card__image--large & {
      padding-bottom: 27.5rem;
    }
  }
}
@media screen and (min-width: 990px) {
  .article-card__link:not(:only-child) {
    margin-right: 4rem;
  }
  .ratio::before {
    .article-card__image--small & {
      padding-bottom: 17.7rem;
    }
    .article-card__image--medium & {
      padding-bottom: 30.7rem;
    }
    .article-card__image--large & {
      padding-bottom: 40.7rem;
    }
  }
}
/* check for flexbox gap in older Safari versions */
@supports not (inset: 10px) {
  .articles-wrapper.grid {
    margin: 0 0 5rem 0;
  }
  @media screen and (min-width: 750px) {
    .articles-wrapper.grid {
      margin-bottom: 7rem;
    }
  }
}
/* ————— Blog ———————————————————— */
.blog-articles {
  display: grid;
  grid-gap: 1rem;
  column-gap: var(--grid-mobile-horizontal-spacing);
  row-gap: var(--grid-mobile-vertical-spacing);
  .card-wrapper {
    width: 100%;
  }
}
@media screen and (min-width: 750px) {
  .blog-articles {
    grid-template-columns: 1fr 1fr;
    column-gap: var(--grid-desktop-horizontal-spacing);
    row-gap: var(--grid-desktop-vertical-spacing);
  }
  .blog-articles--collage > *:nth-child(3n + 1), .blog-articles--collage > *:nth-child(3n + 2):last-child {
    grid-column: span 2;
    text-align: center;
    .card {
      text-align: center;
    }
    .article-card__image--small .ratio::before {
      padding-bottom: 22rem;
    }
    .article-card__image--medium .ratio::before {
      padding-bottom: 44rem;
    }
    .article-card__image--large .ratio::before {
      padding-bottom: 66rem;
    }
  }
}
@media screen and (min-width: 990px) {
  .blog-articles--collage > *:nth-child(3n + 1), .blog-articles--collage > *:nth-child(3n + 2):last-child {
    .article-card__image--small .ratio .ratio::before {
      padding-bottom: 27.5rem;
    }
    .article-card__image--medium .ratio::before {
      padding-bottom: 55rem;
    }
    .article-card__image--large .ratio::before {
      padding-bottom: 82.5rem;
    }
  }
}
{% endstyle %}

{%- paginate blog.articles by 6 -%}
  <div class="main-blog page-width section-{{ section.id }}-padding">
    <h1 class="title--primary{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}">
      {{ blog.title | escape }}
    </h1>

    <div class="blog-articles {% if section.settings.layout == 'collage' %}blog-articles--collage{% endif %}">
      {%- for article in blog.articles -%}
        <div
          class="blog-articles__article article{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {% if settings.animations_reveal_on_scroll %}
            data-cascade
            style="--animation-order: {{ forloop.index }};"
          {% endif %}
        >
          {%- render 'article-card',
            article: article,
            media_height: section.settings.image_height,
            media_aspect_ratio: article.image.aspect_ratio,
            show_image: section.settings.show_image,
            show_date: section.settings.show_date,
            show_author: section.settings.show_author,
            show_excerpt: true
          -%}
        </div>
      {%- endfor -%}
    </div>

    {%- if paginate.pages > 1 -%}
      {%- render 'pagination', paginate: paginate -%}
    {%- endif -%}
  </div>
{%- endpaginate -%}

{% schema %}
{
  "name": "Blog Posts",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "layout",
      "options": [
        {
          "value": "grid",
          "label": "Grid"
        },
        {
          "value": "collage",
          "label": "Collage"
        }
      ],
      "default": "collage",
      "label": "Layout"
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "default": true,
      "label": "Featured Image"
    },
    {
      "type": "select",
      "id": "image_height",
      "options": [
        {
          "value": "adapt",
          "label": "Adapt to Image"
        },
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "medium",
      "label": "Image Height"
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "default": true,
      "label": "Date"
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "default": false,
      "label": "Author"
    }
  ]
}
{% endschema %}
